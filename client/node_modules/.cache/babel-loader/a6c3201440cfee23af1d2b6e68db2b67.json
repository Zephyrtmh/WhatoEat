{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/Zephy/OneDrive/Documents/Personal/Coding/Coding Projects/WhatoEat/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Zephy/OneDrive/Documents/Personal/Coding/Coding Projects/WhatoEat/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Zephy\\\\OneDrive\\\\Documents\\\\Personal\\\\Coding\\\\Coding Projects\\\\WhatoEat\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useContext,useEffect,useRef,useState}from'react';import Filter from'./Filter';import{FoodContext}from'../Context/FoodContext';import{random_food,convertFiltersFormat}from'../utils/utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ListFilters(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),filterAllList=_useState2[0],setFilterList=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),toFilter=_useState4[0],setToFilter=_useState4[1];var _useState5=useState({\"halal\":'either'}),_useState6=_slicedToArray(_useState5,2),activeFilters=_useState6[0],setActiveFilters=_useState6[1];var context=useContext(FoodContext);var handleFilterSelection=function handleFilterSelection(filterName,value){activeFilters[filterName]=value;setActiveFilters(activeFilters);};var handleNoFilter=function handleNoFilter(){setToFilter(!toFilter);console.log(\"toFilter set to \"+!toFilter);};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var convertedActiveFilters,response,resJson;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;convertedActiveFilters=convertFiltersFormat(activeFilters);_context.next=4;return fetch(\"/submit\",{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify(convertedActiveFilters)});case 4:response=_context.sent;resJson=response.json();// let foodNames = resJson.map((foodName) => console.log(foodName));\n_context.next=8;return resJson.then(function(data){var food_names=[];for(var food in data){food_names.push(data[food].food_name);}var rand_food=random_food(food_names);console.log(food_names);console.log(rand_food);random_food(food_names).then(function(food){context.setFoodItem(food);});});case 8:_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log(_context.t0.message);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function handleSubmit(){return _ref.apply(this,arguments);};}();var foodContext=/*#__PURE__*/React.createContext('');var foodFilters=[];useEffect(function(){var getFilters=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response,jsonData,filters,someObj;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return fetch(\"/filters/\");case 3:response=_context3.sent;_context3.next=6;return response.json();case 6:jsonData=_context3.sent;filters=jsonData.map(function(filter){return/*#__PURE__*/_jsx(\"li\",{id:filter,children:/*#__PURE__*/_jsx(Filter,{filterName:filter.filter_name,toFilter:toFilter,handleFilterSelection:handleFilterSelection})});});setFilterList(filters);someObj={};_context3.next=12;return jsonData.forEach(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(element){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:someObj[element.filter_name]='either';// activeFilters[element.food_name] = 'either';\ncase 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref3.apply(this,arguments);};}());case 12:// console.log(someObj);\nsetActiveFilters(someObj);_context3.next=18;break;case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](0);console.error(_context3.t0);case 18:case\"end\":return _context3.stop();}}},_callee3,null,[[0,15]]);}));return function getFilters(){return _ref2.apply(this,arguments);};}();getFilters();},[toFilter]);var noFilterClassName=toFilter?\"no-filter-button-unselected\":\"no-filter-button-selected\";return/*#__PURE__*/_jsxs(\"div\",{id:\"filters-interface-container\",children:[/*#__PURE__*/_jsx(\"button\",{className:noFilterClassName,onClick:handleNoFilter,children:\"Remove filters\"}),/*#__PURE__*/_jsx(\"ul\",{id:\"filter-list\",children:filterAllList}),/*#__PURE__*/_jsx(\"button\",{className:\"submit-button\",onClick:handleSubmit,children:\"Submit\"})]});}export default ListFilters;","map":{"version":3,"names":["React","useContext","useEffect","useRef","useState","Filter","FoodContext","random_food","convertFiltersFormat","ListFilters","props","filterAllList","setFilterList","toFilter","setToFilter","activeFilters","setActiveFilters","context","handleFilterSelection","filterName","value","handleNoFilter","console","log","handleSubmit","convertedActiveFilters","fetch","method","headers","body","JSON","stringify","response","resJson","json","then","data","food_names","food","push","food_name","rand_food","setFoodItem","message","foodContext","createContext","foodFilters","getFilters","jsonData","filters","map","filter","filter_name","someObj","forEach","element","error","noFilterClassName"],"sources":["C:/Users/Zephy/OneDrive/Documents/Personal/Coding/Coding Projects/WhatoEat/client/src/components/ListFilters.js"],"sourcesContent":["import React, { useContext, useEffect, useRef, useState } from 'react';\r\nimport Filter from './Filter';\r\nimport { FoodContext } from '../Context/FoodContext';\r\nimport { random_food, convertFiltersFormat } from '../utils/utils';\r\n\r\nfunction ListFilters(props) {\r\n\r\n    const [filterAllList, setFilterList] = useState([]);\r\n    const [toFilter, setToFilter] = useState(true);\r\n    const [activeFilters, setActiveFilters] = useState({\"halal\": 'either'});\r\n\r\n\r\n    let context = useContext(FoodContext);\r\n\r\n\r\n\r\n\r\n    const handleFilterSelection = (filterName, value) => {\r\n        activeFilters[filterName] = value;\r\n        setActiveFilters(activeFilters);\r\n    }\r\n\r\n    const handleNoFilter = () => {\r\n        setToFilter(!toFilter);\r\n        console.log(\"toFilter set to \"+!toFilter);\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        try {\r\n            const convertedActiveFilters = convertFiltersFormat(activeFilters);\r\n            const response = await fetch(\"/submit\", { method:'POST', headers: {'Accept': 'application/json', 'Content-Type': 'application/json'}, body: JSON.stringify(convertedActiveFilters)});\r\n            let resJson = response.json();\r\n            // let foodNames = resJson.map((foodName) => console.log(foodName));\r\n            await resJson.then((data) => {\r\n                let food_names = [];\r\n                for (let food in data) {\r\n                    food_names.push(data[food].food_name);\r\n                }\r\n                let rand_food = random_food(food_names);\r\n                console.log(food_names);\r\n                console.log(rand_food);\r\n                random_food(food_names).then((food) => {\r\n                    context.setFoodItem(food);\r\n                })\r\n            \r\n            });\r\n        } catch (err) {\r\n            console.log(err.message)\r\n        }\r\n        \r\n    }\r\n\r\n    const foodContext = React.createContext('');\r\n\r\n    let foodFilters = []\r\n    \r\n\r\n    useEffect(() => {\r\n        const getFilters = async () => {\r\n            try {\r\n                // need to add check to prevent infinite loop\r\n                \r\n                const response = await fetch(\"/filters/\");\r\n                const jsonData = await response.json();\r\n                const filters = jsonData.map((filter) => \r\n                <li id={filter}><Filter filterName={filter.filter_name} toFilter={toFilter} handleFilterSelection={handleFilterSelection}/></li>\r\n                );\r\n                setFilterList(filters);\r\n                let someObj = {}\r\n                await jsonData.forEach(async (element) => {\r\n                    someObj[element.filter_name] = 'either';\r\n                    // activeFilters[element.food_name] = 'either';\r\n                })\r\n                // console.log(someObj);\r\n                setActiveFilters(someObj);        \r\n                \r\n                \r\n            } catch (err) {\r\n                console.error(err);\r\n            }\r\n        };\r\n        getFilters();\r\n    }, [toFilter]);\r\n\r\n    let noFilterClassName = toFilter ? \"no-filter-button-unselected\" : \"no-filter-button-selected\";\r\n\r\n    return (\r\n        <div id=\"filters-interface-container\">\r\n            <button className={noFilterClassName} onClick={handleNoFilter}>Remove filters</button>\r\n            <ul id=\"filter-list\">\r\n                {filterAllList}\r\n            </ul>\r\n            <button className=\"submit-button\" onClick={handleSubmit}>Submit</button>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ListFilters"],"mappings":"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"},"metadata":{},"sourceType":"module"}